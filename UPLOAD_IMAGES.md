# Инструкция по загрузке изображений

## Быстрый старт

1. **Убедитесь, что переменные окружения настроены** в `.env.local`:
   ```env
   DATABASE_URL="postgresql://..."
   CLOUDINARY_CLOUD_NAME=your-cloud-name
   CLOUDINARY_API_KEY=your-api-key
   CLOUDINARY_API_SECRET=your-api-secret
   ```

2. **Убедитесь, что база данных заполнена** (выполнен seed):
   ```bash
   npm run prisma:seed
   ```

3. **Запустите скрипт загрузки**:
   ```bash
   npm run upload:images
   ```

## Что делает скрипт

- ✅ Читает все изображения из папки `public/`
- ✅ Автоматически определяет блок по названию файла и папке
- ✅ Загружает изображения в Cloudinary с правильной структурой папок
- ✅ Сохраняет метаданные в базу данных
- ✅ Привязывает изображения к соответствующим блокам
- ✅ Показывает подробный прогресс и статистику

## Маппинг файлов к блокам

### Hero
- Папка: `public/hero/`
- Блок: `hero`
- Примеры: `hero-aerospace-03.jpg`, `hero-forging-press-01.JPG`

### Capabilities
- Папка: `public/capabilities/`
- Блоки определяются по префиксу в названии файла:
  - `raw-materials-*` → блок `raw_materials`
  - `forging-*` → блок `forging`
  - `extrusion-*` → блок `extrusion_rolling`
  - `machining-*` → блок `machining`
  - `printing-*` → блок `printing`
  - `surface-*` → блок `surface_protection`

### Market Segments
- Папка: `public/market/`
- Блоки определяются по префиксу:
  - `market-automotive-*` → блок `market_automotive`
  - `market-aerospace-*` → блок `market_aerospace`
  - `market-industrial-*` → блок `market_industrial`
  - `market-special-*` → блок `market_special`

### Forged Wheels
- Папка: `public/forged wheels/`
- Блок: `wheels`
- Примеры: `wheels-race-01.jpg`, `wheel-finish-03.JPG`

## Поддерживаемые форматы

- `.jpg`, `.jpeg`
- `.png`
- `.webp`
- Регистр расширения не важен (`.JPG`, `.PNG` тоже работают)

## Структура в Cloudinary

Изображения загружаются в папки:
- `reems/hero/`
- `reems/capabilities/raw-materials/`
- `reems/capabilities/forging/`
- `reems/market/automotive/`
- и т.д.

## После загрузки

После успешной загрузки:

1. **Изображения появятся на сайте** автоматически (компоненты уже настроены)
2. **Менеджеры смогут управлять изображениями** через админку:
   - `/admin/pages/home` → выбрать блок → увидеть все изображения
   - Добавлять новые, удалять, менять alt-тексты

3. **Проверить загруженные изображения**:
   ```bash
   npm run check-images
   ```
   (если скрипт существует)

## Устранение проблем

### Ошибка: "Блок 'xxx' не найден в базе данных"
- Убедитесь, что выполнен seed: `npm run prisma:seed`
- Проверьте, что блок с таким ключом существует в БД

### Ошибка: "Не установлены переменные окружения Cloudinary"
- Проверьте файл `.env.local`
- Убедитесь, что переменные называются правильно (без пробелов)

### Файл не определяется для блока
- Проверьте название файла - оно должно соответствовать паттернам выше
- Для hero и forged wheels все файлы в папке будут обработаны

## Примечания

- Скрипт **не удаляет** локальные файлы после загрузки
- Можно запускать несколько раз - дубликаты не создаются (но будут новые записи в БД)
- Видео файлы (`.mp4`) **не обрабатываются** - только изображения
- Большие файлы могут загружаться дольше

